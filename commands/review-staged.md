---
description: 审查 staged 代码变更，检测意外的破坏性修改
---

请审查当前 staged 的代码变更，检查是否存在意外的破坏性修改。

## 本次修改的目标
{用户在命令后提供的修改目标描述}

## 执行步骤

1. **获取变更内容**
   - 运行 `git status` 查看 staged 的文件列表
   - 运行 `git diff --staged` 查看详细的代码变更内容

2. **分析变更范围**
   - 理解本次修改的预期目标（用户提供的目标描述）
   - 识别实际修改的文件和代码范围
   - 对比预期目标和实际修改，检查是否超出范围

3. **检测破坏性变更**

   重点检查以下方面：

   - **API/接口变更**：函数签名修改、参数增删改、返回值变更
   - **删除操作**：删除函数、类、组件、配置项、文件等
   - **重命名影响**：变量、函数、类、文件重命名可能影响其他引用
   - **类型变更**：TypeScript 类型定义、接口、数据结构的修改
   - **配置变更**：环境变量、配置文件、构建配置的修改
   - **依赖变更**：package.json、requirements.txt 等依赖项的变更
   - **数据库/存储**：数据模型、Schema、表结构的变更
   - **行为变更**：核心业务逻辑的重大改变
   - **导出/导入**：模块导出项的变更可能影响外部调用

4. **生成审查报告**

   报告必须包含以下部分：

   ### ✅ 符合预期的修改
   - 列出与修改目标一致的变更
   - 说明这些修改如何实现目标

   ### ⚠️ 需要关注的变更
   - 列出可能有风险但看起来合理的变更
   - 说明潜在影响和需要注意的地方
   - 给出验证建议

   ### 🚨 意外的破坏性修改
   **如果发现破坏性修改，必须在此部分明确报警！**

   对每个破坏性修改，详细说明：
   - 📍 **位置**：具体的文件路径和行号
   - 💥 **变更内容**：具体做了什么修改
   - ⚡ **破坏性原因**：为什么这是破坏性的
   - 📊 **影响范围**：可能影响哪些文件、功能、模块或用户
   - 🔧 **修复建议**：如何修正或需要采取什么措施

   ### 📋 总体建议
   - 是否可以安全提交
   - 需要采取的后续行动
   - 是否需要额外的测试或验证

## 检查标准

- **超出范围**：任何与修改目标无关的代码变更都需要重点关注
- **意外删除**：删除任何功能代码、导出项、公共接口都要报警
- **接口变更**：修改函数签名、参数、返回值等都要评估影响
- **配置修改**：配置、环境变量的修改可能影响运行环境
- **依赖调整**：添加、删除、升级依赖需要评估兼容性

## 要求

- 仔细对比修改目标和实际变更，严格检查
- 对任何超出目标范围的修改保持高度警惕
- 如发现破坏性修改，**必须使用 🚨 明确报警**
- 提供具体的文件路径和行号引用（格式：`文件路径:行号`）
- 给出清晰、可操作的建议
- 所有报告内容使用中文
- 宁可误报也不要漏报破坏性修改
