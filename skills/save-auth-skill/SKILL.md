---
name: save-auth
description: ä¿å­˜ Playwright è®¤è¯çŠ¶æ€ï¼ˆClerk Testing è‡ªåŠ¨è®¤è¯ï¼‰ã€‚å…¨è‡ªåŠ¨ headless æ¨¡å¼ï¼Œæ— éœ€æ‰‹åŠ¨æ“ä½œã€‚
allowed-tools: Bash, Read
---

# Save Auth - Clerk Testing è‡ªåŠ¨è®¤è¯

## é¡¹ç›®çº¦å®š

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| `.claude/config.local.json` | ç«¯å£é…ç½® `{ "ports": { "dev": 3456 } }` |
| `web/.env.local` | ç¯å¢ƒå˜é‡ï¼ˆç”¨æˆ·é…ç½® + CLERK_SECRET_KEYï¼‰ |
| `.auth/user.json` | æ™®é€šç”¨æˆ·è®¤è¯çŠ¶æ€ |
| `.auth/admin.json` | ç®¡ç†å‘˜ç”¨æˆ·è®¤è¯çŠ¶æ€ |

## å‰ç½®æ¡ä»¶

1. åœ¨ Clerk Dashboard åˆ›å»ºæµ‹è¯•ç”¨æˆ·
2. åœ¨ `web/.env.local` é…ç½®ï¼š
   ```
   # æ™®é€šç”¨æˆ·ï¼ˆå¿…é€‰ï¼‰
   E2E_CLERK_USER_USERNAME=test@example.com

   # ç®¡ç†å‘˜ç”¨æˆ·ï¼ˆå¯é€‰ï¼‰
   E2E_CLERK_ADMIN_USERNAME=admin@example.com

   # Clerk å¯†é’¥
   CLERK_SECRET_KEY=sk_test_xxx
   ```
3. å¼€å‘æœåŠ¡å™¨è¿è¡Œä¸­

## æ‰§è¡Œ

```bash
npx tsx ~/.claude/skills/save-auth-skill/scripts/save-auth.ts <project-root> [user-type]
```

å‚æ•°è¯´æ˜ï¼š
- `project-root`: é¡¹ç›®æ ¹ç›®å½•
- `user-type`: å¯é€‰ï¼ŒæŒ‡å®šç”¨æˆ·ç±»å‹
  - `all`ï¼ˆé»˜è®¤ï¼‰: å¤„ç†æ‰€æœ‰é…ç½®çš„ç”¨æˆ·
  - `user`: ä»…å¤„ç†æ™®é€šç”¨æˆ·
  - `admin`: ä»…å¤„ç†ç®¡ç†å‘˜ç”¨æˆ·

è„šæœ¬ä¼šï¼š
1. **æ£€æŸ¥çº¦å®š**ï¼šweb/ ç»“æ„ã€ç¯å¢ƒå˜é‡ã€ä¾èµ–
2. **è‡ªåŠ¨å®‰è£…**ï¼šç¼ºå¤±çš„ @playwright/testã€@clerk/testing
3. **è‡ªåŠ¨ç™»å½•**ï¼šä½¿ç”¨ Clerk Testing SDKï¼ˆheadless æ¨¡å¼ï¼‰
4. **ä¿å­˜è®¤è¯**ï¼š
   - E2E_CLERK_USER_USERNAME â†’ `.auth/user.json`
   - E2E_CLERK_ADMIN_USERNAME â†’ `.auth/admin.json`

## ç¤ºä¾‹

```bash
# ä¿å­˜æ‰€æœ‰ç”¨æˆ·è®¤è¯ï¼ˆé»˜è®¤ï¼‰
npx tsx ~/.claude/skills/save-auth-skill/scripts/save-auth.ts .

# ä»…ä¿å­˜æ™®é€šç”¨æˆ·
npx tsx ~/.claude/skills/save-auth-skill/scripts/save-auth.ts . user

# ä»…ä¿å­˜ç®¡ç†å‘˜
npx tsx ~/.claude/skills/save-auth-skill/scripts/save-auth.ts . admin
```

## è¾“å‡º

```
==================================================
ğŸ” Save Auth - Clerk Testing è‡ªåŠ¨è®¤è¯
==================================================
   é¡¹ç›®: /path/to/project
   ç«¯å£: 3555
   ç”¨æˆ·: 2 ä¸ª
         - æ™®é€šç”¨æˆ·: test@example.com
         - ç®¡ç†å‘˜: admin@example.com
==================================================

ğŸš€ å¯åŠ¨æµè§ˆå™¨...

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ‘¤ æ™®é€šç”¨æˆ·: test@example.com
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ” æ­£åœ¨ç™»å½•...
   âœ… signIn å®Œæˆ
   ğŸ“ éªŒè¯ç™»å½•çŠ¶æ€...
   âœ… ç™»å½•æˆåŠŸï¼
   ğŸ“ å·²ä¿å­˜: /path/to/project/.auth/user.json (27KB)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ‘¤ ç®¡ç†å‘˜: admin@example.com
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   ğŸ” æ­£åœ¨ç™»å½•...
   âœ… signIn å®Œæˆ
   ğŸ“ éªŒè¯ç™»å½•çŠ¶æ€...
   âœ… ç™»å½•æˆåŠŸï¼
   ğŸ“ å·²ä¿å­˜: /path/to/project/.auth/admin.json (27KB)

==================================================
ğŸ“Š è®¤è¯ä¿å­˜ç»“æœ:

   âœ… æ™®é€šç”¨æˆ·
   âœ… ç®¡ç†å‘˜
==================================================

âœ… æ‰€æœ‰ç”¨æˆ·è®¤è¯çŠ¶æ€å·²ä¿å­˜ï¼
```
